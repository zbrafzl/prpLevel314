@{
    ViewBag.Title = "Forgot Password";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
@model Prp.Sln.RegistrationModel
@section RenderCss{

}
@section RenderScript{

    <script>

        var objApplicant = {};

        $(document).ready(function () {

            $("#divError").hide();
            $("#idErrorMsg").html();

            $("#btnForgotPassword").click(function () {
                RecoverPassword();
            });

            $(document).keypress(function (event) {
                var keycode = (event.keyCode ? event.keyCode : event.which);
                if (keycode == '13') {
                    RecoverPassword();
                }
            });
        });



        function RecoverPassword() {

            var errorMsg = "";
            var isError = false;

            $("#divError").hide();
            $("#idErrorMsg").html();

            try {

                if (ValidateForm() == false) {

                    if (isError == false) {

                        var resp = CallActionPost("/LoggedIn/ApplicantForgotPassword", objApplicant)
                        if (resp != null && resp.status == true) {
                            $("#divError").show();

                            $("#divMsg").removeClass("panel-success");
                            $("#divMsg").removeClass("panel-danger");


                            $("#divMsg").addClass("panel-success");
                            $("#idErrorMsg").html("<li>" + resp.message + "</li>");

                            //success
                            
                        }
                        else {

                            $("#divMsg").removeClass("panel-success");
                            $("#divMsg").removeClass("panel-danger");


                            $("#divMsg").addClass("panel-danger");

                            $("#divError").show();
                            $("#idErrorMsg").html("<li>" + resp.message + "</li>");
                        }
                    }
                    else {


                        $("#divMsg").removeClass("panel-success");
                        $("#divMsg").removeClass("panel-danger");


                        $("#divMsg").addClass("panel-danger");

                        $("#divError").show();
                        $("#idErrorMsg").html(errorMsg);
                    }
                }

            } catch (e) {

            }
        }


        function ValidateForm() {


            $(".req-fld").removeClass("req-fld");


            $("#divError").hide();
            $("#idErrorMsg").html("");

            var isError = false, ctrl = "", errorMessage = "";
            objApplicant = {};
            objApplicant.emailId = $("#txtEmail").val();
           
            if (objApplicant.emailId == "") {
                $("#txtEmail").addClass("req-fld");
                isError = true;
                if (ctrl == "")
                    ctrl = "txtEmail";
            }
            else {

                if (ValidateEmail(objApplicant.emailId) == false) {
                    isError = true;
                    errorMessage = errorMessage + "<li>Invalid email id. Please enter valid email id</li>"
                }
            }

            if (ctrl != "")
                $("#" + ctrl).focus();

            if (errorMessage.length > 0) {
                $("#divError").show();
                $("#idErrorMsg").html(errorMessage);
            }

            return isError;

        }
    </script>
}
<div class="container content">
    <div class="row main">
        <div class="col-sm-2"></div>
        <div class="col-sm-8 form-box">
            <div class="main-login main-center">
                <form class="form-horizontal">
                    <h3 class="heading">Forgot Password</h3>
                    <div class="col-sm-12">
                        <div class="cols-sm-10">
                            <div class="input-group mt10">
                                <span class="input-group-addon"><i class="fa fa-envelope fa" aria-hidden="true"></i></span>
                                <input class="form-control" type="email" required="required" maxlength="100" name="txtEmail" id="txtEmail" placeholder="Email">
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-12 ">
                        <div class="col-sm-12" style="margin:10px 0px 20px 0px;">
                            <div class="col-sm-3">
                            </div>
                            <div class="col-sm-6">
                                <input id="btnForgotPassword" type="button" class="btn btn-app animated-button" value="Recover Password"  style="width:100%;" />
                            </div>
                            <div class="col-sm-3">
                            </div>
                        </div>
                    </div>
                    <div id="divError" class="col-sm-12" style=" display:none;">
                        <div id="divMsg" class="panel panel-danger">
                            <div class="panel-heading">
                                <label class="text-center">
                                    <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                                    <ul id="idErrorMsg" class="ul-err">
                                    </ul>
                                </label>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
