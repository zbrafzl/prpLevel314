
@{
    ViewBag.Title = "Constant Manage";
    Layout = "~/Areas/nadmin/Views/Shared/_Layout.cshtml";
}
@model Prp.Sln.ConstantModelAdmin
@section RenderCss{

}
@section RenderScript{

    <script>
        var typeId = 0, parentId = 0;
        $(document).ready(function () {

            typeId = $("#hfdTypeId").val();
            SearchAndBind();

            $("#ddlType").val(typeId);
            $('#ddlType').trigger("chosen:updated");
           

            $(document).on('change', '#ddlType', function () {
                typeId = $(this).val();

                $("#ddlType").val(typeId);
                $('#ddlType').trigger("chosen:updated");

                SearchAndBind();
                //window.location.href = "/admin/constant-manage?typeId=" + typeId;
            });
        });


        function SearchAndBind() {

            var htmlAll = "";
            try {

                var obj = {};
                obj.typeId = typeId;
                obj.parentId = parentId;
                var resp = CallActionPost("/CommonAdmin/ConstantSearch", obj);
                if (resp != null) {

                    //ddlType

                    var list = resp.Table3;
                    if (list != null && list.length > 0) {
                        var objItem = {}, status = "";
                        var htmlSingle = $('#tbRow').html();
                        for (var i = 0; i < list.length; i++) {
                            objItem = list[i];
                            status = "In-Active";
                            if (objItem.isActive == 1)
                                status = "Active";

                            htmlAll = htmlAll + htmlSingle.replace(/{#id#}/g, objItem.id).replace(/{#name#}/g, objItem.name)
                                .replace(/{#parentName#}/g, objItem.parentName).replace(/{#typeName#}/g, objItem.typeName)
                                .replace(/{#status#}/g, status).replace(/{#constantId#}/g, objItem.constantId);
                        }
                    }

                }
            } catch (e) {
                htmlAll = "";
            }
            $('#tbBody').html(htmlAll);


        }
    </script>
}
<div class="col-md-12 col-sm-12  ">
    <div class="x_panel">
        <div class="x_title">
            <h2>Constant Manage </h2>
            <div class="panel_toolbox">
                <a href="/admin/constant-setup" class="btn btn-info"> Add New</a>
            </div>
            <div class="clearfix"></div>
        </div>
        <form class="form-horizontal form-label-left input_mask">
            @Html.HiddenFor(m => m.typeId, new { @id = "hfdTypeId" })
            <div class="form-group col-lg-12">
                <div class="col-md-6 col-sm-6 col-xs-6">
                    <label for="heard">Type :</label>
                    <select id="ddlType" name="ddlType" class="form-control  chosen-select">
                        <option value="0" selected="selected"> Select One </option>
                        @if (Model != null && (Model.listType != null && Model.listType.Count > 0))
                        {
                            foreach (var u in Model.listType)
                            {
                                <option value="@u.id">@u.id - @u.name </option>
                            }
                        }
                    </select>
                </div>
            </div>
            <div class="clearfix"></div>
            <div class="ln_solid"></div>
        </form>
        <div class="x_content">
            <div class="table-responsive">
                <table class="table table-striped jambo_table bulk_action">
                    <thead>
                        <tr class="headings">
                            <th class="column-title">ID </th>
                            <th class="column-title">Name </th>
                            <th class="column-title">Parent </th>
                            <th class="column-title">Type </th>
                            <th class="column-title">Status </th>
                            <th>
                                <span class="nobr">Action</span>
                            </th>
                        </tr>
                    </thead>

                    <tbody id="tbBody">
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<div style="display:none;">
    <table>
        <tbody id="tbRow">
            <tr>
                <td>{#id#}</td>
                <td>{#name#}</td>
                <td>{#parentName#}</td>
                <td>{#typeName#}</td>
                <td>{#status#}</td>
                <td>
                    <a title="Edit Content" class="ank" href="/admin/constant-setup?id={#constantId#}"><i class="fa fa-pencil-square-o"></i></a>
                </td>
            </tr>
        </tbody>
        <tbody id="tbNoRecord">
            <tr>
                <td colspan="7" style="text-align:center;">No record found</td>
            </tr>
        </tbody>
    </table>
</div>
